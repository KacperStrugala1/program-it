{% extends "base.html" %} {% block title %}Stoper | ProgramIT{% endblock %} 
{% block content %}
<div
  class="flex flex-col md:flex-row justify-center items-start gap-10 mt-10 w-full"
>
  <!-- Okno kodu -->
  <div class="code-window w-full md:w-[40rem] overflow-hidden">
    <div
      class="bg-[#21252b] text-[#5c6370] px-4 py-1 text-xs border-b border-[#3e4451]"
    >
      ~/stoper/home.html
    </div>
    <div class="p-4 font-mono text-sm leading-6">
      <div class="flex">
        <div class="text-[#5c6370] w-8 text-right pr-2">1</div>
        <div>
          <span class="text-[#c678dd]">def</span>
          <span class="text-[#61afef]">stoper</span>():
        </div>
      </div>
      <div class="flex">
        <div class="text-[#5c6370] w-8 text-right pr-2">2</div>
        <div>&nbsp;&nbsp;time = "00:00"</div>
      </div>
      <div class="flex">
        <div class="text-[#5c6370] w-8 text-right pr-2">3</div>
        <div>&nbsp;&nbsp;while running:</div>
      </div>
      <div class="flex">
        <div class="text-[#5c6370] w-8 text-right pr-2">4</div>
        <div>&nbsp;&nbsp;&nbsp;&nbsp;update(display)</div>
      </div>
      <div class="flex">
        <div class="text-[#5c6370] w-8 text-right pr-2">5</div>
        <div>&nbsp;&nbsp;&nbsp;&nbsp;sleep(1)</div>
      </div>
      <div class="flex">
        <div class="text-[#5c6370] w-8 text-right pr-2">6</div>
        <div>&nbsp;&nbsp;return time</div>
      </div>
    </div>
  </div>

  <!-- Stoper -->
  <div class="flex flex-col items-center w-full md:w-80 space-y-6">
    <div
      class="bg-[#282c34] border border-[#3e4451] rounded-xl p-6 w-full text-center code-window"
    >
      <h1 class="text-[#61afef] text-lg font-bold mb-4">STOPER</h1>
      <div id="display" class="text-4xl font-mono text-[#98c379] mb-6">
        00:00
      </div>

      <div class="flex justify-center space-x-4">
        <button
          id="start"
          class="px-4 py-2 rounded bg-[#98c379] text-[#1e1e1e] font-semibold hover:bg-[#7cbf69] transition"
        >
          ▶ Start
        </button>
        <button
          id="stop"
          class="px-4 py-2 rounded bg-[#e06c75] text-[#1e1e1e] font-semibold hover:bg-[#c45b64] transition"
        >
          ■ Stop
        </button>
        <button
          id="reset"
          class="px-4 py-2 rounded bg-[#d19a66] text-[#1e1e1e] font-semibold hover:bg-[#c18456] transition"
        >
          ↺ Reset
        </button>
      </div>
    </div>

    <div
      class="bg-[#282c34] border border-[#3e4451] rounded-xl p-6 w-full text-center code-window"
    >
      <h2 class="text-[#61afef] text-base font-bold mb-4">Recent Times</h2>
      <ul
        id="recent"
        class="font-mono text-sm text-[#abb2bf] space-y-1 text-left ml-4"
      ></ul>
    </div>
  </div>
</div>

<script>
  document.addEventListener("DOMContentLoaded", () => {
    const display = document.getElementById("display");
    const startBtn = document.getElementById("start");
    const stopBtn = document.getElementById("stop");
    const resetBtn = document.getElementById("reset");
    const recentList = document.getElementById("recent");

    let startTime = 0,
      elapsedTime = 0,
      timer = null,
      running = false;

    function fmt(ms) {
      const s = Math.floor(ms / 1000);
      const m = Math.floor(s / 60);
      return `${m.toString().padStart(2, "0")}:${(s % 60)
        .toString()
        .padStart(2, "0")}`;
    }

    function update() {
      display.textContent = fmt(elapsedTime);
    }

    startBtn.onclick = () => {
      if (running) return;
      running = true;
      startTime = Date.now() - elapsedTime;
      timer = setInterval(() => {
        elapsedTime = Date.now() - startTime;
        update();
      }, 100);
    };

    stopBtn.onclick = () => {
      if (!running) return;
      running = false;
      clearInterval(timer);
      const time = fmt(elapsedTime);
      const li = document.createElement("li");
      li.textContent = "• " + time;
      li.className = "text-[#98c379]";
      recentList.prepend(li);
      localStorage.setItem(
        "recentTimes",
        JSON.stringify(
          Array.from(recentList.querySelectorAll("li")).map(
            (l) => l.textContent
          )
        )
      );
    };

    resetBtn.onclick = () => {
      running = false;
      clearInterval(timer);
      elapsedTime = 0;
      update();
    };

    JSON.parse(localStorage.getItem("recentTimes") || "[]").forEach((t) => {
      const li = document.createElement("li");
      li.textContent = t;
      li.className = "text-[#98c379]";
      recentList.append(li);
    });

    update();
  });
</script>
{% endblock %}
